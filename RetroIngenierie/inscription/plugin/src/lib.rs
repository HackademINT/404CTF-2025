use wasm_minimal_protocol::*;

initiate_protocol!();

const TABLE: [u8; 256] = [
    92, 248, 105, 58, 229, 133, 178, 130, 31, 78, 204, 131, 192, 36, 186, 187, 219, 153, 232, 124,
    68, 182, 185, 230, 79, 108, 33, 252, 26, 5, 46, 13, 212, 237, 249, 120, 236, 157, 93, 223, 233,
    4, 220, 10, 156, 88, 188, 64, 226, 103, 166, 97, 82, 72, 35, 208, 43, 211, 171, 107, 96, 177,
    114, 62, 222, 173, 29, 54, 183, 84, 9, 122, 163, 180, 137, 148, 66, 126, 241, 89, 227, 98, 100,
    242, 102, 123, 234, 116, 162, 195, 244, 59, 6, 176, 251, 109, 48, 71, 235, 7, 214, 175, 141,
    149, 113, 75, 45, 147, 111, 40, 24, 170, 2, 231, 44, 18, 110, 193, 115, 243, 21, 65, 30, 104,
    168, 27, 15, 202, 12, 49, 80, 60, 255, 201, 205, 158, 67, 38, 74, 239, 1, 142, 77, 228, 57,
    191, 210, 154, 119, 87, 56, 165, 199, 118, 250, 42, 139, 17, 215, 150, 172, 216, 50, 129, 152,
    117, 213, 70, 39, 217, 190, 99, 144, 135, 128, 221, 160, 94, 86, 181, 159, 169, 0, 194, 11,
    174, 3, 203, 136, 146, 179, 112, 34, 254, 197, 81, 63, 37, 14, 8, 253, 16, 73, 143, 85, 125,
    55, 32, 206, 90, 83, 22, 218, 121, 247, 145, 41, 127, 25, 53, 240, 138, 224, 52, 246, 151, 200,
    167, 134, 91, 225, 161, 69, 47, 106, 20, 209, 189, 51, 164, 95, 198, 19, 23, 132, 196, 155,
    245, 140, 207, 238, 61, 28, 184, 101, 76,
];
const C1: [u8; 55] = [
    9, 44, 103, 97, 24, 214, 72, 163, 103, 2, 88, 97, 24, 214, 175, 183, 88, 243, 103, 102, 163,
    88, 66, 82, 110, 97, 21, 88, 241, 226, 243, 88, 110, 195, 227, 72, 102, 88, 75, 242, 88, 40,
    65, 88, 29, 97, 18, 102, 88, 9, 44, 103, 84, 24, 214,
];

#[wasm_func]
pub fn get_flag() -> Vec<u8> {
    b"aHR0cHM6Ly93d3cueW91dHViZS5jb20vd2F0Y2hcP3ZcPXh2RlpqbzVQZ0cwCg==".to_vec()
}

#[wasm_func]
pub fn check(pass: &[u8]) -> Vec<u8> {
    let d: Vec<u8> = pass.iter().map(|c| TABLE[*c as usize]).collect();
    if d.len() != 55 {
        vec![0]
    } else {
        if C1.to_vec() == d {
            vec![1]
        } else {
            vec![0]
        }
    }
}
