// 404 CTF 2025

unsigned long int strlen(const char* s) {
    unsigned long int i = 0;
    while (*s++) {
        i++;
    }
    return i;
}

void puts(const char* s) {
    unsigned long int len = strlen(s);
    register int    arg1        asm("rdi") = 1;
    register char*  arg2        asm("rsi") = (char*)s;
    register int    arg3        asm("rdx") = len;
    register int    syscall_no  asm("rax") = 1;
    asm("syscall");
}

void read(int fd, char* s, int count) {
    register int    arg1        asm("rdi") = fd;
    register char*  arg2        asm("rsi") = (char*)s;
    register int    arg3        asm("rdx") = count;
    register int    syscall_no  asm("rax") = 0;
    asm("syscall");
}

int main(void) {
    puts("Vous vous réveillez près d'un feu de camp, il est temps d'explorer votre système solaire !\n");

    char boucle[4] = "\x01";
    char decisions[0x14];
    
    while (boucle[0])  {
        puts("Que comptez vous faire ?\n");
        puts(">> ");
        read(0, decisions, 0x18 + 22);
        puts("Le soleil explose !\n");
        puts("Vous revoyez vos 22 derniers bytes : ");
        puts(decisions);
        puts("\nMais pas de panique, vous êtes dans une boucle temporelle...");
        puts("\n------------------------------------------------------------------------------\n");
    }
    
    return 0;
}

void _start(void) {
    main();
}